# BirthKeeper 发布前隐私与发布检查清单

更新时间：2026-02-13

## 1. 隐私自检（代码与配置）

### 1.1 权限最小化
- [x] 仅声明必要权限：`POST_NOTIFICATIONS`、`SCHEDULE_EXACT_ALARM`
- [x] 未声明网络权限（`INTERNET`）
- [x] 明文流量关闭：`android:usesCleartextTraffic="false"`

### 1.2 组件暴露面
- [x] `MainActivity` 仅作为 `LAUNCHER` 导出
- [x] `BirthdayReminderAlarmReceiver` 设置 `exported=false`
- [x] 无额外外部可调用 `service/provider`

### 1.3 敏感数据存储
- [x] 身份证号字段入库前加密（`IdNumberCrypto`，Android Keystore + AES-GCM）
- [x] 数据库存储字段为 `id_number_encrypted`（无身份证明文字段）
- [x] 列表默认脱敏展示（`MaskingUtils`）
- [x] 系统自动备份关闭：`android:allowBackup="false"`

### 1.4 备份文件安全
- [x] 导出文件加密（`BackupCipher`，AES-GCM）
- [x] 导入做版本校验、异常回滚（事务）
- [ ] 待加强：`BackupCipher` 当前仍使用代码内固定口令，发布前建议改为用户口令或 Keystore 派生方案

### 1.5 日志与调试信息
- [x] 代码未发现主动打印身份证号明文的日志语句（`Log/println/printStackTrace` 扫描）
- [ ] 待确认：三方库运行日志需在发布构建中进一步压制（R8/日志级别）

## 2. 发布包检查（当前状态）

### 2.1 构建与安装
- [x] `:app:assembleDebug` 通过
- [x] `:app:installDebug` 通过（真机）
- [x] `:app:installRelease` 通过（真机，本地回归口径）

### 2.2 自动化验证
- [x] `:app:connectedDebugAndroidTest` 通过（含 4 条 `MainActivityAndroidTest`）
- [x] 已覆盖提醒通知点击状态流转：`PLANNED -> SENT -> CLICKED -> DONE`

### 2.3 性能验收（冷启动）
- [x] `release` 口径达标：20 次 COLD，`TotalTime P95=535ms`（目标 `<1500ms`）
- [ ] 待补：多机型 `release` 口径复测（至少再补 1 台中端机）

### 2.4 发布前必须收口项
- [ ] 切换正式发布签名（当前 `release` 使用本地 `debug` 签名用于回归）
- [ ] 确认应用图标、应用名、隐私说明页文案为发布版本配置
- [ ] 增补“隐私政策/数据处理说明”对外文档（若计划上架）

## 3. 本次已执行命令（节选）

```powershell
. "D:\Video Downloader\环境一键配置.ps1"
.\gradlew.bat :app:connectedDebugAndroidTest "-Pandroid.testInstrumentationRunnerArguments.class=com.zhongxul.birthkeeper.MainActivityAndroidTest"
.\gradlew.bat :app:installDebug
.\gradlew.bat :app:installRelease
.\scripts\startup-benchmark.ps1 -Runs 20 -OutputCsv .\docs\startup-benchmark-2026-02-13-release.csv
```
